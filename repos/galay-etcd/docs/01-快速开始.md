# 快速开始

## 0. 依赖

- Galay 内部依赖（构建必需 + 联调推荐）：
  - [galay-kernel](https://github.com/gzj-creator/galay-kernel)（构建必需）
  - [galay-utils](https://github.com/gzj-creator/galay-utils)（推荐）
  - [galay-http](https://github.com/gzj-creator/galay-http)（推荐）
- 第三方依赖：
  - C++23 编译器
  - CMake 3.20+
  - simdjson（pkg-config）
  - spdlog

## 1. 构建

```bash
git clone https://github.com/gzj-creator/galay-kernel.git
git clone https://github.com/gzj-creator/galay-utils.git
git clone https://github.com/gzj-creator/galay-http.git
git clone https://github.com/gzj-creator/galay-etcd.git
cd galay-etcd
cmake -S . -B build -DCMAKE_BUILD_TYPE=Release
cmake --build build --parallel
```

仅单独构建 `galay-etcd` 时，最小内部依赖为 `galay-kernel` 和 `galay-http`。

## 2. 协程会话接口最小示例

```cpp
#include "galay-etcd/sync/EtcdClient.h"
#include <galay-kernel/kernel/Runtime.h>
#include <iostream>

using namespace galay::kernel;

Coroutine run(IOScheduler* scheduler) {
    galay::etcd::EtcdConfig cfg;
    cfg.endpoint = "http://127.0.0.1:2379";
    galay::etcd::EtcdClient session(scheduler, cfg);

    auto conn = co_await session.connect();
    if (!conn) co_return;

    auto put = co_await session.put("/demo/key", "hello");
    if (!put) co_return;

    auto get = co_await session.get("/demo/key");
    if (!get) co_return;
    for (const auto& kv : session.lastKeyValues()) {
        std::cout << kv.key << " => " << kv.value << "\n";
    }

    auto del = co_await session.del("/demo/key");
    if (!del) co_return;

    co_await session.close();
}
```

## 3. 异步客户端最小示例

```cpp
#include "galay-etcd/async/AsyncEtcdClient.h"
#include <galay-kernel/kernel/Runtime.h>

using namespace galay::kernel;

Coroutine run(IOScheduler* scheduler) {
    galay::etcd::AsyncEtcdClient client(scheduler);

    co_await client.connect();
    if (!client.lastError().isOk()) co_return;

    co_await client.put("/demo/async", "value");
    co_await client.get("/demo/async");

    co_await client.close();
}
```
