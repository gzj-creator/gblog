# 4-性能测试

## 概述

本文档为性能测试总览，汇总 `B1/B2/B3` 三项基准结果。
详细原始数据保留在各自 `B*` 报告中。

## 测试环境

| 项目 | 配置 |
|------|------|
| CPU | Apple M4 |
| CPU核心数 | 10 |
| 内存 | 24 GB |
| 操作系统 | macOS 15.7.3 |
| 编译器 | Apple LLVM 17.0.0 (clang-1700.0.13.5) |
| 测试日期 | 2026-02-15 |

## 基准参数

1. `B1-StdioPerformance`：每个测试项 `1000` 次请求。
2. `B2-HttpPerformance`：`32` 连接，`1000` 请求/连接，`IO=4`，`Compute=2`。
3. `B3-ConcurrentRequests`：`--scalability`，并发 `1/2/4/8/16/32`，每 worker `100` 请求。

## 结果摘要

### B1 Stdio（本地 IPC）

| 测试项 | 平均延迟 | P95 延迟 | QPS |
|--------|----------|----------|-----|
| Ping | 0.02 ms | 0.02 ms | 56,650.80 |
| Tool Call | 0.03 ms | 0.04 ms | 33,760.97 |
| Resource Read | 0.03 ms | 0.03 ms | 34,485.14 |
| List Tools | 0.06 ms | 0.07 ms | 17,574.07 |
| List Resources | 0.03 ms | 0.03 ms | 36,016.57 |
| List Prompts | 0.03 ms | 0.04 ms | 32,632.82 |

### B2 HTTP（32 连接并发）

| 测试项 | 成功率 | 平均延迟 | P95 延迟 | QPS |
|--------|--------|----------|----------|-----|
| HTTP Ping | 100% | 0.48 ms | 0.59 ms | 61,420.35 |
| HTTP Tool Call | 100% | 0.63 ms | 0.79 ms | 46,783.63 |
| HTTP Resource Read | 100% | 0.56 ms | 0.72 ms | 55,267.70 |
| HTTP List Tools | 100% | 0.50 ms | 0.85 ms | 60,491.49 |
| HTTP List Resources | 100% | 0.45 ms | 0.54 ms | 68,085.11 |
| HTTP List Prompts | 100% | 0.47 ms | 0.68 ms | 60,836.50 |

### B3 HTTP 并发扩展（Tool Call）

| Workers | 总请求数 | 平均延迟 | P95 延迟 | QPS |
|---------|----------|----------|----------|-----|
| 1 | 100 | 0.07 ms | 0.10 ms | 970.87 |
| 2 | 200 | 0.08 ms | 0.10 ms | 1,923.08 |
| 4 | 400 | 0.14 ms | 0.26 ms | 3,846.15 |
| 8 | 800 | 0.21 ms | 0.28 ms | 7,692.31 |
| 16 | 1600 | 0.51 ms | 1.64 ms | 15,384.62 |
| 32 | 3200 | 0.61 ms | 0.74 ms | 31,067.96 |

## 结论

1. Stdio 在本地通信场景保持最低延迟（0.02~0.06 ms）。
2. HTTP 在 32 连接压测下全部接口成功率 100%，吞吐达到 `46k~68k req/s`。
3. 并发扩展测试中，`32 workers` 达到 `31,067.96 req/s`，具备稳定扩展能力。

## 详细报告

1. [B1-Stdio性能测试报告](B1-Stdio性能测试.md)
2. [B2-HTTP性能测试报告](B2-HTTP性能测试.md)
3. [B3-并发请求压测报告](B3-并发请求压测.md)
